{"version":3,"file":"littlefoot.mjs","sources":["../src/dom/element.ts","../src/dom/layout.ts","../src/dom/footnote.ts","../src/dom/scroll.ts","../src/dom/document.ts","../src/dom/events.ts","../src/settings.ts","../src/littlefoot.ts","../src/use-cases.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null],"names":["addClass","element","className","classList","add","removeClass","remove","hasClass","contains","CLASS_TOOLTIP","getLeftRelative","marginLeft","Number","parseFloat","getStyle","width","offsetWidth","getBoundingClientRect","left","window","innerWidth","repositionPopover","popover","button","current","next","room","marginSize","parseInt","popoverHeight","offsetHeight","roomAbove","top","roomBelow","innerHeight","getFootnotePosition","transformX","transformY","style","transformOrigin","CLASS_ACTIVE","CLASS_CHANGING","CLASS_SCROLLABLE","footnoteActions","id","content","host","wrapper","maxHeight","position","isMounted","document","body","activate","onActivate","setAttribute","insertAdjacentElement","maxWidth","clientWidth","Math","round","pixels","dismiss","onDismiss","isActive","isReady","ready","reposition","height","min","scrollHeight","removeAttribute","resize","getLeftInPixels","tooltip","querySelector","repositionTooltip","destroy","CLASS_FULLY_SCROLLED","scrollHandler","event","currentTarget","delta","deltaY","clientHeight","availableHeight","scrollTop","CLASS_CONTENT","CLASS_WRAPPER","CLASS_PRINT_ONLY","setAllPrintOnly","elements","forEach","e","queryAll","parent","selector","Array","from","querySelectorAll","getByClassName","firstElementChild","createElementFromHTML","html","container","createElement","innerHTML","isDefined","value","undefined","recursiveHideFootnoteContainer","parentElement","visibleElements","visibleSeparators","filter","el","tagName","length","concat","recursiveUnmount","stopElement","replace","prepareTemplateData","reference","index","outerHTML","bl","trim","String","number","startsWith","interpolate","template","replacement","_","key","_a","createElements","buttonTemplate","popoverTemplate","renderButton","renderPopover","values","dataset","footnoteButton","footnoteId","footnotePopover","addEventListener","throttle","bindScrollHandler","setup","allowDuplicates","anchorParentSelector","anchorPattern","contentTemplate","footnoteSelector","numberResetSelector","scope","footnotes","pattern","link","href","rel","match","findFootnoteLinks","map","processed","fragment","split","CSS","escape","find","footnote","includes","closest","push","findReference","resetSelector","previousParent","resetNumbers","i","unmount","SELECTOR_FOOTNOTE","closestTarget","target","getFootnoteId","hoverHandler","action","preventDefault","onDocument","onWindow","delegate","eventType","listener","options","call","DEFAULT_SETTINGS","activateDelay","activateOnHover","allowMultiple","dismissDelay","dismissOnUnhover","dismissOnDocumentTouch","hoverDelay","littlefoot","userSettings","settings","Object","assign","useCases","hovered","delay","dismissCallback","setTimeout","activateCallback","ifFound","dismissAll","touchOutside","repositionAll","resizeAll","toggle","hover","unhover","f","createUseCases","removeListeners","toggleOnTouch","throttledReposition","throttledResize","showOnHover","hideOnHover","controller","AbortController","signal","keyCode","abort","addListeners","getSetting","updateSetting"],"mappings":"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"}